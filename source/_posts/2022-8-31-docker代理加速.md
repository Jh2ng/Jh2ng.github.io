---
title: vulhub本地环境搭建
author: jh2ng
cover: 'http://image.jh2ing.com/image-20220831141025850.png'
tags:
  - 环境搭建
categories:
  - Linux
abbrlink: 3352
date: 2022-08-31 15:50:00
---

之前通过国外主机搭建vulhub环境，为了节约成本，使用VMware搭建本地环境，避免麻烦虚拟机直接走物理机代理。

前期准备：

- VMware
- Centos7
- 代理软件（v2ray）

虚拟机安装Centos7之后，设置代理，IP设置为物理机IP，端口为代理软件代理端口。

![image-20220831135432974](http://image.jh2ing.com/image-20220831135432974.png)

以上是图形化界面的设置，如果是命令行，可在配置文件`/etc/profile`中添加代理配置进行代理，针对个人用户在`~/.bash_profile`中修改，临时代理直接命令行`export http_proxy='http://ip:port'`

配置文件修改：

```
export http_proxy='http://ip:port'    //代理服务器ip地址和端口号
export https_proxy='http://ip:port'   //代理服务器ip地址和端口号
```

代理软件设置允许来自局域网的连接，注意物理机的防火墙设置，确保虚拟机可以连接到此端口

![image-20220831135554708](http://image.jh2ing.com/image-20220831135554708.png)

开启之后虚拟机即可访问

![image-20220831141025850](http://image.jh2ing.com/image-20220831141025850.png)

vulhub需要docker环境，这里直接复制菜鸟教程的安装教程

> https://www.runoob.com/docker/centos-docker-install.html

```
curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun
```

dcoker-compose安装

```
curl -L https://get.daocloud.io/docker/compose/releases/download/v2.4.1/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose

$ sudo chmod +x /usr/local/bin/docker-compose
$ sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
```

实现docker通过代理pull镜像

```
mkdir -p /etc/systemd/system/docker.service.d
nano /etc/systemd/system/docker.service.d/http-proxy.conf
```

http-proxy.conf

```
[Service]
Environment="HTTP_PROXY=http://ip:port"
Environment="HTTPS_PROXY=https://ip:port"
```

然后重启docker

```
systemctl daemon-reload
systemctl restart docker
```

查看是否配置

```
systemctl show --property=Environment docker
```

docker测试，下载速度很快

![image-20220831154940397](http://image.jh2ing.com/image-20220831154940397.png)
